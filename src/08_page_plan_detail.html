<div id="page-plan-detail" style="display:none; padding-bottom: 80px; background: #f7f8fa; min-height: 100vh;">
    <!-- Detail Header -->
    <div style="background: white; padding: 20px 20px 10px 20px; border-bottom: 1px solid #f0f0f0; position: sticky; top: 0; z-index: 10;">
        <div style="display: flex; align-items: center; margin-bottom: 15px;">
             <button onclick="closePlanDetail()" style="background:none; border:none; font-size: 20px; color: #333; padding: 0 10px 0 0;">←</button>
             <div style="flex: 1; text-align: center; padding-right: 30px; display: flex; align-items: center; justify-content: center; gap: 8px;">
                <span id="planDetailTitle" style="font-size: 18px; font-weight: bold;">计划详情</span>
                <span onclick="renameCurrentPlan()" style="cursor: pointer; font-size: 14px; opacity: 0.6;">✏️</span>
             </div>
        </div>
        
        <!-- Tags Area -->
        <div style="margin-bottom: 15px; text-align: center;">
            <div id="planDetailTags" style="display:flex; flex-wrap:wrap; justify-content:center; gap:5px; margin-bottom:5px;"></div>
            <span onclick="openTagManageModal()" style="font-size:12px; color:#4a90e2; cursor:pointer; background:#f0f7ff; padding:2px 8px; border-radius:10px;">+ 添加标签</span>
        </div>
        
        <!-- Status Banner -->
        <div id="planDetailStatus" style="background: #fffbe6; color: #fa8c16; padding: 15px; border-radius: 8px; font-size: 15px; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 8px; margin-bottom: 15px; text-align: center;">
             <span></span> 计划中 - 尚未扣减库存
        </div>

        <!-- Key Stats -->
        <div style="display: flex; justify-content: space-around; margin-bottom: 15px;">
             <div style="text-align: center;">
                 <div id="planDetailColorCount" style="font-size: 24px; font-weight: bold; color: #722ed1;">0</div>
                 <div style="font-size: 13px; color: #999;">颜色数</div>
             </div>
             <div style="text-align: center;">
                 <div id="planDetailBeadCount" style="font-size: 24px; font-weight: bold; color: #fa8c16;">0</div>
                 <div style="font-size: 13px; color: #999;">总粒数</div>
             </div>
        </div>
    </div>



    <!-- Action Buttons -->
    <div id="planDetailActions" style="padding: 15px 20px; background: white; margin-bottom: 10px; display: flex; gap: 10px;">
         <button class="m-btn m-btn-primary" onclick="checkPlanStock()" style="flex: 1; background: #1890ff; border-color: #1890ff; display: flex; align-items: center; justify-content: center; gap: 5px;">
             🔍 库存确认
         </button>
         <button class="m-btn m-btn-primary" onclick="executePlanDeduction()" style="flex: 1; background: #52c41a; border-color: #52c41a; display: flex; align-items: center; justify-content: center; gap: 5px;">
             ▶ 执行扣减
         </button>
    </div>

    <!-- Image Preview (Restored) -->
    <div id="planDetailImageContainer" style="padding: 0 20px; margin-bottom: 15px; display: none;">
         <div onclick="openPlanImageViewer()" style="position: relative; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer; height: 180px;">
             <img id="planDetailImage" src="" style="width: 100%; height: 100%; object-fit: cover; display: block; background: #f0f0f0;">

         </div>
    </div>

    <!-- Color List Header -->
    <div style="padding: 0 20px;">
        <div style="display: flex; justify-content: space-between; margin-bottom: 10px; align-items: center;">
             <h4 style="margin: 0; font-size: 14px; color: #666;">颜色用量</h4>
             <span id="planDetailSortBtn" onclick="togglePlanDetailSort()" style="font-size: 12px; color: #1890ff; cursor: pointer; background: #e6f7ff; padding: 2px 8px; border-radius: 4px;">按用量 ↓</span>
        </div>
        <div id="planDetailList" style="display: flex; flex-direction: column; gap: 10px;">
             <!-- Items -->
        </div>
    </div>
</div>

